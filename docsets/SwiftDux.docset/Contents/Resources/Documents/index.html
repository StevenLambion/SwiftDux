<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SwiftDux  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>
    <a title="SwiftDux  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SwiftDux Docs</a> (88% documented)</p>
        <p class="header-right"><a href="https://github.com/StevenLambion/SwiftDux"><img src="img/gh.png"/>View on GitHub</a></p>
        <p class="header-right">
          <form role="search" action="search.json">
            <input type="text" placeholder="Search documentation" data-typeahead>
          </form>
        </p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SwiftDux Reference</a>
        <img id="carat" src="img/carat.png" />
        SwiftDux  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a href="getting-started.html">Getting Started</a>
              </li>
              <li class="nav-group-task">
                <a href="persisting-state.html">Persisting State</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="State.html">State</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="State.html#/s:8SwiftDux9StateTypea">StateType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/IdentifiableState.html">IdentifiableState</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OrderedState.html">OrderedState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Actions.html">Actions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Action.html">Action</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionPlan.html">ActionPlan</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ActionDispatcher.html">ActionDispatcher</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RunnableAction.html">RunnableAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/EmptyAction.html">EmptyAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Actions.html#/s:8SwiftDux10SendActiona">SendAction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Store.html">Store</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Store.html">Store</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/StoreProxy.html">StoreProxy</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/StoreAction.html">StoreAction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Reducer.html">Reducer</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CompositeReducer.html">CompositeReducer</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Middleware.html">Middleware</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Middleware.html">Middleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CompositeMiddleware.html">CompositeMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HandleActionMiddleware.html">HandleActionMiddleware</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="SwiftUI.html">SwiftUI</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/View.html">View</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MappedState.html">MappedState</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MappedDispatch.html">MappedDispatch</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ConnectableView.html">ConnectableView</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionBinder.html">ActionBinder</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionBinding.html">ActionBinding</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/StorePublisher.html">StorePublisher</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StoreWrapperEnvironmentKey.html">StoreWrapperEnvironmentKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/EnvironmentValues.html">EnvironmentValues</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Publisher.html">Publisher</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/RangeReplaceableCollection.html">RangeReplaceableCollection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other%20Functions.html#/s:8SwiftDux1poiyAA15CompositeActionVAA0D0_p_AaE_ptF">+(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Other%20Functions.html#/s:8SwiftDux1poiyAA16CompositeReducerCy5StateQzxq_Gx_q_tAA0D0RzAaHR_AEQy_AFRSr0_lF">+(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Other%20Functions.html#/s:8SwiftDux1poiyAA19CompositeMiddlewareVy5StateQzxq_Gx_q_tAA0D0RzAaHR_AEQy_AFRSr0_lF">+(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AnyStore.html">AnyStore</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Connectable.html">Connectable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ConnectableViewModifier.html">ConnectableViewModifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/StateStorable.html">StateStorable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/ActionDispatcherProxy.html">ActionDispatcherProxy</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CompositeAction.html">CompositeAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Connector.html">Connector</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnActionViewModifier.html">OnActionViewModifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnAppearDispatchActionPlanViewModifier.html">OnAppearDispatchActionPlanViewModifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/OnAppearDispatchActionViewModifier.html">OnAppearDispatchActionViewModifier</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other%20Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other%20Typealiases.html#/s:8SwiftDux21SendCancellableActiona">SendCancellableAction</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='swiftdux' class='heading'>SwiftDux</h1>

<blockquote>
<p>Predictable state management for SwiftUI applications.</p>
</blockquote>

<p><a href="https://swift.org/"><img src="https://img.shields.io/badge/swift-5.3-orange.svg" alt="Swift Version"></a>
<img src="https://img.shields.io/badge/platforms-iOS%2014%20%7C%20macOS%2011.0%20%7C%20tvOS%2014%20%7C%20watchOS%207-222.svg" alt="Platform Versions">
<a href="https://github.com/StevenLambion/SwiftDux/actions"><img src="https://github.com/StevenLambion/SwiftDux/workflows/build/badge.svg" alt="Github workflow"></a>
<a href="https://codecov.io/gh/StevenLambion/SwiftDux"><img src="https://codecov.io/gh/StevenLambion/SwiftDux/branch/master/graph/badge.svg" alt="codecov"></a></p>

<p>SwiftDux is a state container inspired by Redux and built on top of Combine and SwiftUI. It helps you write applications with predictable, consistent, and highly testable logic using a single source of truth.</p>
<h1 id='installation' class='heading'>Installation</h1>
<h2 id='prerequisites' class='heading'>Prerequisites</h2>

<ul>
<li>Xcode 12+</li>
<li>Swift 5.3+</li>
<li>iOS 14+, macOS 11.0+, tvOS 14+, or watchOS 7+</li>
</ul>
<h2 id='install-via-xcode' class='heading'>Install via Xcode:</h2>

<p>Search for SwiftDux in Xcode&rsquo;s Swift Package Manager integration.</p>
<h2 id='install-via-the-swift-package-manager' class='heading'>Install via the Swift Package Manager:</h2>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
  <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/StevenLambion/SwiftDux.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"2.0.0"</span><span class="p">)</span>
  <span class="p">]</span>
<span class="p">)</span>
</code></pre>
<h1 id='demo-application' class='heading'>Demo Application</h1>

<p>Take a look at the <a href="https://github.com/StevenLambion/SwiftUI-Todo-Example">Todo Example App</a> to see how SwiftDux works.</p>
<h1 id='getting-started' class='heading'>Getting Started</h1>

<p>SwiftDux helps build SwiftUI-based applications around an <a href="https://guide.elm-lang.org/architecture/">elm-like architecture</a> using a single, centralized state container. It has 4 basic constructs:</p>

<ul>
<li><strong>State</strong> - An immutable, single source of truth within the application.</li>
<li><strong>Action</strong> - Describes a single change of the state.</li>
<li><strong>Reducer</strong> - Returns a new state by consuming the previous one with an action.</li>
<li><strong>View</strong> - The visual representation of the current state.</li>
</ul>

<div style="text-align:center">
  <img src="Guides/Images/architecture.jpg" width="400"/>
</div>
<h2 id='state' class='heading'>State</h2>

<p>The state is an immutable structure acting as the single source of truth within the application.</p>

<p>Below is an example of a todo app&rsquo;s state. It has a root <code>AppState</code> as well as an ordered list of <code>TodoItem</code> objects.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">typealias</span> <span class="kt">StateType</span> <span class="o">=</span> <span class="kt">Equatable</span> <span class="o">&amp;</span> <span class="kt">Codable</span>

<span class="kd">struct</span> <span class="kt">AppState</span><span class="p">:</span> <span class="kt">StateType</span> <span class="p">{</span>
  <span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">TodoItem</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">TodoItem</span><span class="p">:</span> <span class="kt">StateType</span><span class="p">,</span> <span class="kt">Identifiable</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
  <span class="k">var</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</code></pre>
<h2 id='actions' class='heading'>Actions</h2>

<p>An action is a dispatched event to mutate the application&rsquo;s state. Swift&rsquo;s enum type is ideal for actions, but structs and classes could be used as well.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="kd">enum</span> <span class="kt">TodoAction</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
  <span class="k">case</span> <span class="nf">addTodo</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">removeTodos</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">)</span>
  <span class="k">case</span> <span class="nf">moveTodos</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">IndexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h2 id='reducers' class='heading'>Reducers</h2>

<p>A reducer consumes an action to produce a new state.</p>
<pre class="highlight swift"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">TodosReducer</span><span class="p">:</span> <span class="kt">Reducer</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">reduce</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kt">TodoAction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AppState</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">switch</span> <span class="n">action</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">addTodo</span><span class="p">(</span><span class="k">let</span> <span class="nv">text</span><span class="p">):</span>
      <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">TodoItemState</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="n">text</span><span class="p">))</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">removeTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">remove</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">moveTodos</span><span class="p">(</span><span class="k">let</span> <span class="nv">indexSet</span><span class="p">,</span> <span class="k">let</span> <span class="nv">index</span><span class="p">):</span>
      <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="o">.</span><span class="nf">move</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">indexSet</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">state</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='store' class='heading'>Store</h2>

<p>The store manages the state and notifies the views of any updates.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span>
  <span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="p">()),</span>
  <span class="nv">reducer</span><span class="p">:</span> <span class="kt">AppReducer</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="kt">UIHostingController</span><span class="p">(</span>
  <span class="nv">rootView</span><span class="p">:</span> <span class="kt">RootView</span><span class="p">()</span><span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
<h2 id='middleware' class='heading'>Middleware</h2>

<p>SwiftDux supports middleware to extend functionality. The SwiftDuxExtras module provides two built-in middleware to get started:</p>

<ul>
<li><code>PersistStateMiddleware</code> persists and restores the application state between sessions.</li>
<li><code>PrintActionMiddleware</code> prints out each dispatched action for debugging purposes.</li>
</ul>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">SwiftDux</span>

<span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span>
  <span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="p">()),</span>
  <span class="nv">reducer</span><span class="p">:</span> <span class="kt">AppReducer</span><span class="p">(),</span>
  <span class="nv">middleware</span><span class="p">:</span> <span class="kt">PrintActionMiddleware</span><span class="p">())</span>
<span class="p">)</span>

<span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="kt">UIHostingController</span><span class="p">(</span>
  <span class="nv">rootView</span><span class="p">:</span> <span class="kt">RootView</span><span class="p">()</span><span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
<h2 id='composing-reducers-middleware-and-actions' class='heading'>Composing Reducers, Middleware, and Actions</h2>

<p>You may compose a set of reducers, actions, or middleware into an ordered chain using the &lsquo;+&rsquo; operator.</p>
<pre class="highlight swift"><code><span class="c1">// Break up an application into smaller modules by composing reducers.</span>
<span class="k">let</span> <span class="nv">rootReducer</span> <span class="o">=</span> <span class="kt">AppReducer</span><span class="p">()</span> <span class="o">+</span> <span class="kt">NavigationReducer</span><span class="p">()</span>

<span class="c1">// Add multiple middleware together.</span>
<span class="k">let</span> <span class="nv">middleware</span> <span class="o">=</span> 
  <span class="kt">PrintActionMiddleware</span><span class="p">()</span> <span class="o">+</span>
  <span class="kt">PersistStateMiddleware</span><span class="p">(</span><span class="kt">JSONStatePersistor</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span>
  <span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="p">()),</span>
  <span class="nv">reducer</span><span class="p">:</span> <span class="n">reducer</span><span class="p">,</span>
  <span class="nv">middleware</span><span class="p">:</span> <span class="n">middleware</span>
<span class="p">)</span>
</code></pre>
<h2 id='connectableview' class='heading'>ConnectableView</h2>

<p>The <code><a href="Protocols/ConnectableView.html">ConnectableView</a></code> protocol provides a slice of the application state to your views using the functions <code>map(state:)</code> or  <code>map(state:binder:)</code>. It automatically updates the view when the props value has changed.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">TodosView</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>
  <span class="kd">struct</span> <span class="kt">Props</span><span class="p">:</span> <span class="kt">Equatable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">todos</span><span class="p">:</span> <span class="p">[</span><span class="kt">TodoItem</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Props</span><span class="p">?</span> <span class="p">{</span>
    <span class="kt">Props</span><span class="p">(</span><span class="nv">todos</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">Todo</span><span class="o">&gt;</span><span class="p">):</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span>
      <span class="kt">ForEach</span><span class="p">(</span><span class="n">todos</span><span class="p">)</span> <span class="p">{</span> <span class="n">todo</span> <span class="k">in</span>
        <span class="kt">TodoItemRow</span><span class="p">(</span><span class="nv">item</span><span class="p">:</span> <span class="n">todo</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='actionbinding-lt-_-gt' class='heading'>ActionBinding&lt;_&gt;</h2>

<p>Use the <code>map(state:binder:)</code> method on the <code><a href="Protocols/ConnectableView.html">ConnectableView</a></code> protocol to bind an action to the props object. It can also be used to bind an updatable state value with an action.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">TodosView</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>
  <span class="kd">struct</span> <span class="kt">Props</span><span class="p">:</span> <span class="kt">Equatable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">todos</span><span class="p">:</span> <span class="p">[</span><span class="kt">TodoItem</span><span class="p">]</span>
    <span class="kd">@ActionBinding</span> <span class="k">var</span> <span class="nv">newTodoText</span><span class="p">:</span> <span class="kt">String</span>
    <span class="kd">@ActionBinding</span> <span class="k">var</span> <span class="nv">addTodo</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">,</span> <span class="nv">binder</span><span class="p">:</span> <span class="kt">ActionBinder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">Todo</span><span class="o">&gt;</span><span class="p">?</span> <span class="p">{</span>
    <span class="kt">Props</span><span class="p">(</span>
      <span class="nv">todos</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">todos</span><span class="p">,</span>
      <span class="nv">newTodoText</span><span class="p">:</span> <span class="n">binder</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">newTodoText</span><span class="p">)</span> <span class="p">{</span> <span class="kt">TodoAction</span><span class="o">.</span><span class="nf">setNewTodoText</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">},</span>
      <span class="nv">addTodo</span><span class="p">:</span> <span class="n">binder</span><span class="o">.</span><span class="n">bind</span> <span class="p">{</span> <span class="kt">TodoAction</span><span class="o">.</span><span class="nf">addTodo</span><span class="p">()</span> <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="kt">OrderedState</span><span class="o">&lt;</span><span class="kt">Todo</span><span class="o">&gt;</span><span class="p">):</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span>
      <span class="kt">TextField</span><span class="p">(</span><span class="s">"New Todo"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="n">props</span><span class="o">.</span><span class="err">$</span><span class="n">newTodoText</span><span class="p">,</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="n">props</span><span class="o">.</span><span class="n">addTodo</span><span class="p">)</span> 
      <span class="kt">ForEach</span><span class="p">(</span><span class="n">todos</span><span class="p">)</span> <span class="p">{</span> <span class="n">todo</span> <span class="k">in</span>
        <span class="kt">TodoItemRow</span><span class="p">(</span><span class="nv">item</span><span class="p">:</span> <span class="n">todo</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='action-plans' class='heading'>Action Plans</h2>

<p>An <code><a href="Structs/ActionPlan.html">ActionPlan</a></code> is a special kind of action that can be used to group other actions together or perform any kind of async logic outside of a reducer. It&rsquo;s also useful for actions that may require information about the state before it can be dispatched.</p>
<pre class="highlight swift"><code><span class="c1">/// Dispatch multiple actions after checking the current state of the application.</span>
<span class="k">let</span> <span class="nv">plan</span> <span class="o">=</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span> <span class="k">in</span>
  <span class="k">guard</span> <span class="n">store</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">someValue</span> <span class="o">==</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionA</span><span class="p">)</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionB</span><span class="p">)</span>
  <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">actionC</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">/// Subscribe to services and return a publisher that sends actions to the store.</span>
<span class="k">let</span> <span class="nv">plan</span> <span class="o">=</span> <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span> <span class="k">in</span>
  <span class="n">userLocationService</span>
    <span class="o">.</span><span class="n">publisher</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">LocationAction</span><span class="o">.</span><span class="nf">updateUserLocation</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='action-dispatching' class='heading'>Action Dispatching</h2>

<p>You can access the <code><a href="Protocols/ActionDispatcher.html">ActionDispatcher</a></code> of the store through the environment values. This allows you to dispatch actions from any view.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">MyView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
  <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">actionDispatcher</span><span class="p">)</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">dispatch</span>

  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">MyForm</span><span class="o">.</span><span class="n">onAppear</span> <span class="p">{</span> <span class="nf">dispatch</span><span class="p">(</span><span class="kt">FormAction</span><span class="o">.</span><span class="n">prepare</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>If it&rsquo;s an ActionPlan that&rsquo;s meant to be kept alive through a publisher, then you&rsquo;ll want to send it as a cancellable. The action below subscribes
to the store, so it can keep a list of albums updated when the user applies different queries.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">AlbumListAction</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">updateAlbumList</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
    <span class="kt">ActionPlan</span><span class="o">&lt;</span><span class="kt">AppState</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">store</span> <span class="k">in</span>
      <span class="n">store</span>
        <span class="o">.</span><span class="n">publish</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">albumList</span><span class="o">.</span><span class="n">query</span> <span class="p">}</span>
        <span class="o">.</span><span class="nf">debounce</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nv">scheduler</span><span class="p">:</span> <span class="kt">RunLoop</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">AlbumService</span><span class="o">.</span><span class="nf">all</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
        <span class="o">.</span><span class="nf">switchToLatest</span><span class="p">()</span>
        <span class="o">.</span><span class="k">catch</span> <span class="p">{</span> <span class="kt">Just</span><span class="p">(</span><span class="kt">AlbumListAction</span><span class="o">.</span><span class="nf">setError</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
        <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">AlbumListAction</span><span class="o">.</span><span class="nf">setAlbums</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">AlbumListContainer</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>
  <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">actionDispatcher</span><span class="p">)</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">dispatch</span>
  <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">cancellable</span><span class="p">:</span> <span class="kt">Cancellable</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Album</span><span class="p">]?</span> <span class="p">{</span>
    <span class="n">state</span><span class="o">.</span><span class="n">albumList</span><span class="o">.</span><span class="n">albums</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="p">[</span><span class="kt">Album</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">AlbumsList</span><span class="p">(</span><span class="nv">albums</span><span class="p">:</span> <span class="n">props</span><span class="p">)</span><span class="o">.</span><span class="n">onAppear</span> <span class="p">{</span> 
      <span class="n">cancellable</span> <span class="o">=</span> <span class="n">dispatch</span><span class="o">.</span><span class="nf">sendAsCancellable</span><span class="p">(</span><span class="kt">AlbumListAction</span><span class="o">.</span><span class="n">updateAlbumList</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The above can be further simplified by using the built-in <code>onAppear(dispatch:)</code> method instead. This method not only dispatches regular actions, but it automatically handles cancellable ones. By default, the action will cancel itself when the view is destroyed.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">AlbumListContainer</span><span class="p">:</span> <span class="kt">ConnectableView</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">map</span><span class="p">(</span><span class="nv">state</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Album</span><span class="p">]?</span> <span class="p">{</span>
    <span class="kt">Props</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">albumList</span><span class="o">.</span><span class="n">albums</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="nv">props</span><span class="p">:</span> <span class="p">[</span><span class="kt">Album</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">AlbumsList</span><span class="p">(</span><span class="nv">albums</span><span class="p">:</span> <span class="n">props</span><span class="p">)</span><span class="o">.</span><span class="nf">onAppear</span><span class="p">(</span><span class="nv">dispatch</span><span class="p">:</span> <span class="kt">AlbumListAction</span><span class="o">.</span><span class="n">updateAlbumList</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='previewing-connected-views' class='heading'>Previewing Connected Views</h2>

<p>To preview a connected view by itself use the <code>provideStore(_:)</code> method inside the preview.</p>
<pre class="highlight swift"><code><span class="cp">#if DEBUG</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="kt">TodoRowContainer_Previews</span><span class="p">:</span> <span class="kt">PreviewProvider</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">TodoList</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kt">Store</span><span class="p">(</span>
      <span class="nv">state</span><span class="p">:</span> <span class="kt">TodoList</span><span class="p">(</span>
        <span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
        <span class="nv">name</span><span class="p">:</span> <span class="s">"TodoList"</span><span class="p">,</span>
        <span class="nv">todos</span><span class="p">:</span> <span class="o">.</span><span class="nf">init</span><span class="p">([</span>
          <span class="kt">Todo</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="s">"Get milk"</span><span class="p">)</span>
        <span class="p">])</span>
      <span class="p">),</span>
      <span class="nv">reducer</span><span class="p">:</span> <span class="kt">TodosReducer</span><span class="p">()</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">previews</span><span class="p">:</span> <span class="n">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">TodoRowContainer</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">provideStore</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2020-11-23)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
